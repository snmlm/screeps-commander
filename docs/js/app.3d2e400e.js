(function(t){function e(e){for(var n,o,r=e[0],c=e[1],l=e[2],d=0,v=[];d<r.length;d++)o=r[d],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&v.push(i[o][0]),i[o]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);u&&u(e);while(v.length)v.shift()();return s.push.apply(s,l||[]),a()}function a(){for(var t,e=0;e<s.length;e++){for(var a=s[e],n=!0,r=1;r<a.length;r++){var c=a[r];0!==i[c]&&(n=!1)}n&&(s.splice(e--,1),t=o(o.s=a[0]))}return t}var n={},i={app:0},s=[];function o(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=t,o.c=n,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(a,n,function(e){return t[e]}.bind(null,n));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var u=c;s.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("cd49")},"143e":function(t,e,a){},"221e":function(t,e,a){},"2bea":function(t,e,a){},"374d":function(t,e,a){"use strict";var n=a("2bea"),i=a.n(n);i.a},4223:function(t,e,a){"use strict";var n=a("221e"),i=a.n(n);i.a},"428b":function(t,e,a){},"5d9d":function(t,e,a){"use strict";var n=a("7391"),i=a.n(n);i.a},6695:function(t,e,a){"use strict";var n=a("428b"),i=a.n(n);i.a},7391:function(t,e,a){},cd49:function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),i=a("bc3a"),s=a.n(i),o=a("4328"),r=a.n(o);s.a.interceptors.request.use((function(t){return t.headers["Access-Control-Allow-Origin"]="*",t}));var c=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=t;return s()({url:n,params:e,method:"get",headers:a})},l=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e=r.a.stringify(e);var n=t;return s()({url:n,data:e,method:"post",headers:a})},u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("div",[a("v-app-bar",{attrs:{color:"blue accent-3",dark:"",app:""}},[a("v-app-bar-nav-icon",{on:{click:function(e){e.stopPropagation(),t.sideDrawerVisiable=!t.sideDrawerVisiable}}}),a("v-toolbar-title",[t._v("Screeps Commander")])],1)],1),a("navigation",{attrs:{show:t.sideDrawerVisiable},on:{"on-close":function(e){t.sideDrawerVisiable=!1}}}),a("v-content",{attrs:{app:""}},[a("router-view")],1)],1)},d=[],v=a("d4ec"),m=a("99de"),b=a("7e84"),p=a("262e"),h=a("9ab4"),f=a("60a3"),k=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"nav-container"},[a("v-navigation-drawer",{attrs:{app:"",temporary:""},model:{value:t.sidebarDrawerVisiable,callback:function(e){t.sidebarDrawerVisiable=e},expression:"sidebarDrawerVisiable"}},[a("v-list-item",[a("v-list-item-content",[a("v-list-item-title",{staticClass:"title"},[t._v("Screeps Commander")]),a("v-list-item-subtitle",[t._v("@snmlm")])],1)],1),a("v-divider"),a("v-list",{attrs:{dense:"",nav:""}},t._l(t.items,(function(e){return a("v-list-item",{key:e.title,attrs:{link:""},on:{click:function(a){return t.onClickSidebar(e.comp,e.persistent)}}},[a("v-list-item-icon",[a("v-icon",[t._v(t._s(e.icon))])],1),a("v-list-item-content",[a("v-list-item-title",[t._v(t._s(e.title))])],1)],1)})),1)],1),a("v-dialog",{attrs:{eager:"",persistent:t.sidebarPersistent},model:{value:t.sidebarVisiable,callback:function(e){t.sidebarVisiable=e},expression:"sidebarVisiable"}},[a(t.activeSidebar,{tag:"component",on:{"on-finish":t.onSidebarFinish}})],1)],1)},g=[],y=a("5530"),C=a("bee2"),O=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-title",{staticClass:"title font-weight-regular justify-space-between pb-1"},[a("span",[t._v(t._s(t.editMode?"编辑按钮":"添加新按钮"))]),a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:function(e){t.showHelp=!0}}},[a("v-icon",[t._v("mdi-help-circle-outline")])],1)],1),a("v-card-text",[a("v-text-field",{staticClass:"mb-4",attrs:{label:"名称","hide-details":"",clearable:""},model:{value:t.commandInfo.title,callback:function(e){t.$set(t.commandInfo,"title",e)},expression:"commandInfo.title"}}),a("v-text-field",{staticClass:"mb-4",attrs:{label:"目标 shard（置空以使用全局 shard）","hide-details":"",clearable:""},model:{value:t.commandInfo.shard,callback:function(e){t.$set(t.commandInfo,"shard",e)},expression:"commandInfo.shard"}}),a("v-textarea",{staticClass:"mb-4",attrs:{label:"命令","hide-details":"","auto-grow":"",clearable:"",rows:"1"},model:{value:t.commandInfo.body,callback:function(e){t.$set(t.commandInfo,"body",e)},expression:"commandInfo.body"}}),a("div",{staticClass:"mt-5"},[t._l(t.params,(function(e,n){return[a("div",{staticClass:"mb-2 d-flex justify-space-between"},[a("v-btn",{staticClass:"mr-2",attrs:{color:"error",small:"",icon:""},on:{click:function(e){return t.removeParam(n)}}},[a("v-icon",[t._v("mdi-close-circle")])],1),a("v-btn",{staticClass:"flex-grow-1",attrs:{small:""},on:{click:function(e){return t.editParam(n)}}},[a("span",{staticClass:"d-inline-block text-truncate text-no-wrap"},[t._v(t._s(e.label))]),a("v-spacer"),a("span",[t._v(t._s(e.match))])],1)],1)]})),a("v-btn",{attrs:{block:"",small:""},on:{click:t.addNewParam}},[t._v("添加参数")])],2)],1),a("v-divider"),a("v-card-actions",[a("v-btn",{attrs:{depressed:"",width:"100"},on:{click:function(e){t.showCancelConfirm=!0}}},[t._v(t._s(t.editMode?"返回":"放弃"))]),a("v-spacer"),a("v-btn",{attrs:{color:"primary",width:"100",depressed:""},on:{click:t.saveNewButton}},[t._v(t._s(t.editMode?"保存":"创建"))])],1),a("v-dialog",{model:{value:t.showCancelConfirm,callback:function(e){t.showCancelConfirm=e},expression:"showCancelConfirm"}},[a("v-card",[a("v-card-text",{staticClass:"pa-4"},[a("div",{staticClass:"text-center mb-4"},[t._v("确认放弃编辑？"+t._s(t.editMode?"新修改的内容不会被保存":"该按钮的所有配置都将被清空。"))]),a("v-btn",{attrs:{color:"error",block:""},on:{click:t.cancel}},[t._v("确认")])],1)],1)],1),a("button-help",{attrs:{show:t.showHelp},on:{"on-close":function(e){t.showHelp=!1}}}),a("param-config",{attrs:{show:t.showParamConfig},on:{"on-cancel":function(e){t.showParamConfig=!1},"on-confirm":t.updateParam},model:{value:t.editParamData,callback:function(e){t.editParamData=e},expression:"editParamData"}})],1)},j=[],w=(a("caad"),a("d81d"),a("a434"),a("ac1f"),a("2532"),a("466d"),"screepsCommandStorage"),V="shard3",x=[{title:"查看 tick 时间",shard:"shard3",body:"Game.time",param:[]},{title:"查看 Creep 数量",shard:"shard3",body:"Object.keys(Game.creeps).length",param:[]},{title:"查看指定房间 RCL",shard:"shard3",body:"Game.rooms.$0.controller.level",param:[{label:"查看房间",default:"W1N1",match:"$0"}]}],_=function(t){function e(){return Object(v["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(p["a"])(e,t),Object(C["a"])(e,[{key:"init",value:function(){var t=localStorage.getItem(w);t?this.dataBase=JSON.parse(t):(this.dataBase={shard:V,commands:x},this.save())}},{key:"get",value:function(){return this.dataBase}},{key:"getOrigin",value:function(){var t=localStorage.getItem(w);return"string"===typeof t?t:""}},{key:"saveOrigin",value:function(t){localStorage.setItem(w,t),this.init()}},{key:"addNewCommand",value:function(t){this.dataBase.commands.push(t),this.save()}},{key:"updateCommand",value:function(t,e){t>=this.dataBase.commands.length||(this.dataBase.commands[t]=e,this.save())}},{key:"removeCommand",value:function(t){this.dataBase.commands.splice(t,1),this.save()}},{key:"setShard",value:function(t){this.dataBase.shard=t,this.save()}},{key:"setToken",value:function(t){this.dataBase||this.init(),this.dataBase.token=t,this.save()}},{key:"save",value:function(){localStorage.setItem(w,JSON.stringify(this.dataBase))}},{key:"exist",get:function(){var t=localStorage.getItem(w);return"string"===typeof t}}]),e}(f["e"]);_=Object(h["a"])([f["a"]],_);var S=new _,T=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{on:{"click:outside":t.onClose},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("v-card",[a("v-card-text",{staticClass:"pa-2"},t._l(t.info,(function(e,n){return a("v-list-item",{key:n},[a("v-list-item-content",[a("v-list-item-title",{staticClass:"font-weight-bold"},[t._v(t._s(e.title))]),a("div",{staticClass:"pt-1 lh"},[t._v(t._s(e.content))]),e.code?a("code",{staticClass:"mt-2 pa-1"},[t._v(t._s(e.code))]):t._e()],1)],1)})),1)],1)],1)},I=[],L=function(t){function e(){var t;return Object(v["a"])(this,e),t=Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.info=[{title:"命令",content:"命令是点击该按钮时发送到 screeps 的代码主体。支持任何可以在游戏控制台中执行的表达式。如下：",code:"Object.key(Game.creeps).length"},{title:"参数",content:"为了提高功能性，你可以通过新建多个参数来实现诸如 ”从某房发送某资源到某房“ 的操作。参数会在点击按钮时通过弹出框进行收集。"},{title:"占位符",content:"占位符代表着参数将要插入到的命令位置，参数在新建时会自动分配以 $ 开头的占位符。如果在命令中没有找到对应的占位符，该参数将被抛弃。占位符允许在命令中出现多次。",code:"Game.rooms.$1.controller.level"}],t}return Object(p["a"])(e,t),Object(C["a"])(e,[{key:"onClose",value:function(){}}]),e}(f["e"]);Object(h["a"])([Object(f["d"])({required:!0})],L.prototype,"show",void 0),Object(h["a"])([Object(f["b"])("on-close")],L.prototype,"onClose",null),L=Object(h["a"])([f["a"]],L);var P=L,B=P,D=(a("f035"),a("2877")),$=a("6544"),N=a.n($),E=a("b0af"),M=a("99d9"),A=a("169a"),F=a("da13"),W=a("5d23"),J=Object(D["a"])(B,T,I,!1,null,"5d709b86",null),q=J.exports;N()(J,{VCard:E["a"],VCardText:M["b"],VDialog:A["a"],VListItem:F["a"],VListItemContent:W["a"],VListItemTitle:W["c"]});var G=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{attrs:{persistent:""},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("v-card",[a("v-card-title",{staticClass:"title font-weight-regular justify-space-between pb-1"},[t._v("参数配置")]),a("v-card-text",[a("v-text-field",{attrs:{label:"占位符","hide-details":"",disabled:""},model:{value:t.value.match,callback:function(e){t.$set(t.value,"match",e)},expression:"value.match"}}),a("v-text-field",{staticClass:"mt-4",attrs:{rules:t.rules,counter:t.inputLimit,label:"标签",clearable:""},model:{value:t.value.label,callback:function(e){t.$set(t.value,"label",e)},expression:"value.label"}}),a("v-text-field",{attrs:{label:"默认值","hide-details":"",clearable:""},model:{value:t.value.default,callback:function(e){t.$set(t.value,"default",e)},expression:"value.default"}})],1),a("v-divider"),a("v-card-actions",[a("v-btn",{on:{click:t.cancel}},[t._v("取消")]),a("v-spacer"),a("v-btn",{attrs:{color:"primary",dark:""},on:{click:t.confirm}},[t._v("确定")])],1)],1)],1)},R=[],H=function(t){function e(){var t;return Object(v["a"])(this,e),t=Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.inputLimit=20,t.rules=[function(e){return!e||e.length<=t.inputLimit||"超过字数限制"}],t}return Object(p["a"])(e,t),Object(C["a"])(e,[{key:"confirm",value:function(){return""===this.value.label&&(this.value.label="未命名参数"),this.value.label.length>this.inputLimit&&(this.value.label=this.value.label.substring(0,this.inputLimit)),this.value}},{key:"cancel",value:function(){}}]),e}(f["e"]);Object(h["a"])([Object(f["d"])({required:!0,default:{match:"",default:"",label:""}})],H.prototype,"value",void 0),Object(h["a"])([Object(f["d"])({required:!0})],H.prototype,"show",void 0),Object(h["a"])([Object(f["b"])("on-confirm")],H.prototype,"confirm",null),Object(h["a"])([Object(f["b"])("on-cancel")],H.prototype,"cancel",null),H=Object(h["a"])([f["a"]],H);var U=H,X=U,z=a("8336"),K=a("ce7e"),Q=a("2fa4"),Y=a("8654"),Z=Object(D["a"])(X,G,R,!1,null,null,null),tt=Z.exports;N()(Z,{VBtn:z["a"],VCard:E["a"],VCardActions:M["a"],VCardText:M["b"],VCardTitle:M["c"],VDialog:A["a"],VDivider:K["a"],VSpacer:Q["a"],VTextField:Y["a"]});var et={ButtonHelp:q,ParamConfig:tt},at=function(t){function e(){var t;return Object(v["a"])(this,e),t=Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.editMode=!1,t.params=[],t.showCancelConfirm=!1,t.showHelp=!1,t.showParamConfig=!1,t.editParamIndex=0,t.editParamData={label:"",default:"",match:""},t.commandInfo={title:"新按钮",shard:V,body:"Game.time"},t}return Object(p["a"])(e,t),Object(C["a"])(e,[{key:"switchToEditMode",value:function(t){if(!(this.editIndex<0)){this.editMode=!0;var e=JSON.parse(JSON.stringify(S.get().commands[t]));this.params=e.param,this.commandInfo=e}}},{key:"addNewParam",value:function(){var t=this.params.length,e=this.params.map((function(t){return t.match}));while(e.includes("$".concat(t)))t+=1;this.params.push({label:"参数".concat(t),default:"",match:"$".concat(t)})}},{key:"removeParam",value:function(t){this.params.splice(t,1)}},{key:"editParam",value:function(t){this.editParamIndex=t,this.editParamData=this.params[t],this.showParamConfig=!0}},{key:"updateParam",value:function(t){this.showParamConfig=!1,this.params[this.editParamIndex]=t}},{key:"reset",value:function(){this.params=[],this.commandInfo={title:"新按钮",shard:V,body:"Game.time"}}},{key:"saveNewButton",value:function(){var t=this.editMode?"保存成功":"添加成功，点击右下角按钮查看",e=JSON.parse(JSON.stringify(Object(y["a"])({},this.commandInfo,{param:this.params})));return this.editMode?S.updateCommand(this.editIndex,e):S.addNewCommand(e),this.reset(),{show:!0,color:"success",content:t}}},{key:"cancel",value:function(){return this.reset(),{show:!1}}}]),e}(f["e"]);Object(h["a"])([Object(f["d"])()],at.prototype,"editIndex",void 0),Object(h["a"])([Object(f["f"])("editIndex")],at.prototype,"switchToEditMode",null),Object(h["a"])([Object(f["b"])("on-finish")],at.prototype,"saveNewButton",null),Object(h["a"])([Object(f["b"])("on-finish")],at.prototype,"cancel",null),at=Object(h["a"])([Object(f["a"])({components:Object(y["a"])({},et)})],at);var nt=at,it=nt,st=a("132d"),ot=a("a844"),rt=Object(D["a"])(it,O,j,!1,null,null,null),ct=rt.exports;N()(rt,{VBtn:z["a"],VCard:E["a"],VCardActions:M["a"],VCardText:M["b"],VCardTitle:M["c"],VDialog:A["a"],VDivider:K["a"],VIcon:st["a"],VSpacer:Q["a"],VTextField:Y["a"],VTextarea:ot["a"]});var lt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-title",{staticClass:"title font-weight-regular justify-space-between pb-1"},[t._v("按钮配置")]),a("v-list",t._l(t.commands,(function(e,n){return a("div",{key:n,staticClass:"item"},[a("v-list-item",[a("span",{staticClass:"d-inline-block text-truncate text-no-wrap"},[t._v(t._s(e.title))]),a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:function(e){return t.editButton(n)}}},[a("v-icon",[t._v("mdi-pencil-plus")])],1),a("v-btn",{attrs:{icon:""},on:{click:function(e){return t.buttonRemovePrepare(n)}}},[a("v-icon",{attrs:{color:"error"}},[t._v("mdi-delete")])],1)],1),n!=t.commands.length-1?a("v-divider"):t._e()],1)})),0),0===t.commands.length?a("div",{staticClass:"d-flex justify-center align-center pb-4 text--secondary"},[a("v-icon",{staticClass:"mr-1",attrs:{color:"grey lighten-1"}},[t._v("mdi-emoticon-sad")]),a("div",[t._v("暂无按钮")])],1):t._e(),a("v-dialog",{model:{value:t.removeConfirmVisiable,callback:function(e){t.removeConfirmVisiable=e},expression:"removeConfirmVisiable"}},[a("v-card",[a("v-card-text",{staticClass:"pa-4"},[a("div",{staticClass:"text-center mb-4"},[t._v("确认删除？该按钮的所有配置都将被清空。")]),a("v-btn",{attrs:{color:"error",block:""},on:{click:t.removeButton}},[t._v("确认")])],1)],1)],1),a("v-dialog",{attrs:{eager:"",persistent:""},model:{value:t.editVisiable,callback:function(e){t.editVisiable=e},expression:"editVisiable"}},[a("button-edit",{attrs:{"edit-index":t.editIndex},on:{"on-finish":t.onEditFinish}})],1)],1)},ut=[],dt=function(t){function e(){var t;return Object(v["a"])(this,e),t=Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.removeConfirmVisiable=!1,t.waitRemoveButtonIndex=0,t.commands=S.get().commands,t.editVisiable=!1,t.editIndex=-1,t}return Object(p["a"])(e,t),Object(C["a"])(e,[{key:"buttonRemovePrepare",value:function(t){this.waitRemoveButtonIndex=t,this.removeConfirmVisiable=!0}},{key:"removeButton",value:function(){this.removeConfirmVisiable=!1,S.removeCommand(this.waitRemoveButtonIndex)}},{key:"editButton",value:function(t){this.editVisiable=!0,this.editIndex=t}},{key:"onEditFinish",value:function(){this.editIndex=-1,this.editVisiable=!1}}]),e}(f["e"]);dt=Object(h["a"])([Object(f["a"])({components:{ButtonEdit:ct}})],dt);var vt=dt,mt=vt,bt=a("8860"),pt=Object(D["a"])(mt,lt,ut,!1,null,"dc8a008c",null),ht=pt.exports;N()(pt,{VBtn:z["a"],VCard:E["a"],VCardText:M["b"],VCardTitle:M["c"],VDialog:A["a"],VDivider:K["a"],VIcon:st["a"],VList:bt["a"],VListItem:F["a"],VSpacer:Q["a"]});var ft=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-title",{staticClass:"title font-weight-regular justify-space-between pb-1"},[a("span",[t._v("设置全局 shard")])]),a("v-card-text",{staticClass:"pt-0"},[a("v-text-field",{attrs:{label:"shard 名称","hide-details":""},model:{value:t.shard,callback:function(e){t.shard=e},expression:"shard"}}),a("div",{staticClass:"mt-5 caption grey--text text--darken-1"},[t._v("用于确定本应用控制台命令发送到的 shard（默认为 shard3）。命令按钮中配置的 shard 值会覆盖该选项。")])],1),a("v-divider"),a("v-card-actions",[a("v-btn",{attrs:{depressed:""},on:{click:t.cancel}},[t._v("取消")]),a("v-spacer"),a("v-btn",{attrs:{color:"primary",depressed:""},on:{click:t.confirm}},[t._v("确认")])],1)],1)},kt=[],gt=function(t){function e(){var t;return Object(v["a"])(this,e),t=Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.shard="",t}return Object(p["a"])(e,t),Object(C["a"])(e,[{key:"confirm",value:function(){""===this.shard&&(this.shard=V),S.setShard(this.shard),this.finish()}},{key:"finish",value:function(){return{show:!0,content:"已将控制台输入重定向到 ".concat(this.shard),color:"success"}}},{key:"cancel",value:function(){return{show:!1}}},{key:"mounted",value:function(){this.shard=S.get().shard}}]),e}(f["e"]);Object(h["a"])([Object(f["b"])("on-finish")],gt.prototype,"finish",null),Object(h["a"])([Object(f["b"])("on-finish")],gt.prototype,"cancel",null),gt=Object(h["a"])([f["a"]],gt);var yt=gt,Ct=yt,Ot=Object(D["a"])(Ct,ft,kt,!1,null,"777a6aac",null),jt=Ot.exports;N()(Ot,{VBtn:z["a"],VCard:E["a"],VCardActions:M["a"],VCardText:M["b"],VCardTitle:M["c"],VDivider:K["a"],VSpacer:Q["a"],VTextField:Y["a"]});var wt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-text",{staticClass:"py-5 text-center"},[a("div",{staticClass:"subtitle-1"},[t._v(t._s(t.introduce))]),a("v-text-field",{attrs:{label:"粘贴至此处","hide-details":"",clearable:""},model:{value:t.newToken,callback:function(e){t.newToken=e},expression:"newToken"}})],1),a("v-card-actions",[t.statsConfirm?a("v-btn",{on:{click:t.cancelLoad}},[t._v("取消")]):t._e(),t.statsConfirm?a("v-spacer"):t._e(),a("v-btn",{attrs:{block:!t.statsConfirm,color:t.btnColor,dark:""},on:{click:t.confirmImport}},[t._v(t._s(t.btnText))])],1)],1)},Vt=[],xt=function(t){function e(){var t;return Object(v["a"])(this,e),t=Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.newToken="",t.statsConfirm=!1,t}return Object(p["a"])(e,t),Object(C["a"])(e,[{key:"confirmImport",value:function(){this.statsConfirm?this.importToken():this.statsConfirm=!0}},{key:"cancelLoad",value:function(){this.statsConfirm=!1}},{key:"importToken",value:function(){S.setToken(this.newToken),this.statsConfirm=!1,this.finish(),this.newToken=""}},{key:"finish",value:function(){return{show:!0,content:this.newToken?"导入成功, 已启用免登陆":"移除成功，免登陆已关闭",color:"success"}}},{key:"introduce",get:function(){return this.statsConfirm?"接下来的操作会覆盖你的现存 Token，是否继续？":"将 AuthToken 粘贴至此处来更新您的配置，置空来移除 token"}},{key:"btnText",get:function(){return this.statsConfirm?"我了解，确认":"应用"}},{key:"btnColor",get:function(){return this.statsConfirm?"error":"primary"}}]),e}(f["e"]);Object(h["a"])([Object(f["b"])("on-finish")],xt.prototype,"finish",null),xt=Object(h["a"])([f["a"]],xt);var _t=xt,St=_t,Tt=Object(D["a"])(St,wt,Vt,!1,null,null,null),It=Tt.exports;N()(Tt,{VBtn:z["a"],VCard:E["a"],VCardActions:M["a"],VCardText:M["b"],VSpacer:Q["a"],VTextField:Y["a"]});var Lt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-text",{staticClass:"py-5 text-center"},[a("div",{staticClass:"subtitle-1"},[t._v(t._s(t.introduce))]),a("v-text-field",{attrs:{label:"粘贴至此处","hide-details":"",clearable:""},model:{value:t.newConfig,callback:function(e){t.newConfig=e},expression:"newConfig"}})],1),a("v-card-actions",[t.statsConfirm?a("v-btn",{on:{click:t.cancelLoad}},[t._v("取消")]):t._e(),t.statsConfirm?a("v-spacer"):t._e(),a("v-btn",{attrs:{block:!t.statsConfirm,color:t.btnColor,dark:""},on:{click:t.confirmLoad}},[t._v(t._s(t.btnText))])],1)],1)},Pt=[],Bt=function(t){function e(){var t;return Object(v["a"])(this,e),t=Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.newConfig="",t.statsConfirm=!1,t}return Object(p["a"])(e,t),Object(C["a"])(e,[{key:"confirmLoad",value:function(){""!==this.newConfig&&(this.statsConfirm?this.loadConfig():this.statsConfirm=!0)}},{key:"cancelLoad",value:function(){this.statsConfirm=!1}},{key:"loadConfig",value:function(){S.saveOrigin(this.newConfig),this.statsConfirm=!1,this.newConfig="",this.finish()}},{key:"finish",value:function(){return{show:!0,content:"导入成功",color:"success"}}},{key:"introduce",get:function(){return this.statsConfirm?"接下来的操作会覆盖你的现存配置项，是否继续？":"将配置项粘贴到下方并点击”应用“按钮来导入配置项。"}},{key:"btnText",get:function(){return this.statsConfirm?"我了解，确认":"应用"}},{key:"btnColor",get:function(){return this.statsConfirm?"error":"primary"}}]),e}(f["e"]);Object(h["a"])([Object(f["b"])("on-finish")],Bt.prototype,"finish",null),Bt=Object(h["a"])([f["a"]],Bt);var Dt=Bt,$t=Dt,Nt=Object(D["a"])($t,Lt,Pt,!1,null,null,null),Et=Nt.exports;N()(Nt,{VBtn:z["a"],VCard:E["a"],VCardActions:M["a"],VCardText:M["b"],VSpacer:Q["a"],VTextField:Y["a"]});var Mt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-text",{staticClass:"text-center"},[a("div",{staticClass:"subtitle-1 pt-5"},[t._v("该配置项可能会包含您的 token，请不要分享给其他人。")]),a("v-text-field",{staticClass:"mb-4",attrs:{"hide-details":""},model:{value:t.copyContent,callback:function(e){t.copyContent=e},expression:"copyContent"}}),a("v-btn",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:t.copyContent,expression:"copyContent",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.onError,expression:"onError",arg:"error"}],attrs:{block:"",color:"primary",dark:""}},[t._v("导出配置项")])],1)],1)},At=[],Ft=function(t){function e(){var t;return Object(v["a"])(this,e),t=Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.copyContent="",t}return Object(p["a"])(e,t),Object(C["a"])(e,[{key:"onCopy",value:function(){return{show:!0,content:"已导出到剪切板",color:"success"}}},{key:"onError",value:function(){return{show:!0,content:"异常，可能已经导出完成，请粘贴确认",color:"error"}}},{key:"mounted",value:function(){this.copyContent=S.getOrigin()}}]),e}(f["e"]);Object(h["a"])([Object(f["b"])("on-finish")],Ft.prototype,"onCopy",null),Object(h["a"])([Object(f["b"])("on-finish")],Ft.prototype,"onError",null),Ft=Object(h["a"])([f["a"]],Ft);var Wt=Ft,Jt=Wt,qt=Object(D["a"])(Jt,Mt,At,!1,null,"22e0ac38",null),Gt=qt.exports;N()(qt,{VBtn:z["a"],VCard:E["a"],VCardText:M["b"],VTextField:Y["a"]});var Rt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-text",{staticClass:"pa-2"},[a("v-list-item",[a("v-list-item-content",[a("v-list-item-title",{staticClass:"font-weight-bold"},[t._v("作者")]),a("div",{staticClass:"pt-1"},[a("span",[t._v("本应用由")]),a("a",{on:{click:function(e){return t.openPage(t.homePage)}}},[t._v(" HoPGoldy")]),a("span",[t._v(" 制作并开源。")])])],1)],1),a("v-list-item",[a("v-list-item-content",[a("v-list-item-title",{staticClass:"font-weight-bold"},[t._v("数据")]),a("div",{staticClass:"pt-1"},[t._v("本应用所有数据均保存在本地，自动或手动清除浏览器缓存将可能导致数据丢失（确保浏览器已退出无痕模式），请妥善使用导出 / 导入功能。")])],1)],1),a("v-list-item",[a("v-list-item-content",[a("v-list-item-title",{staticClass:"font-weight-bold"},[t._v("隐私")]),a("div",{staticClass:"pt-1"},[t._v("本应用不会保存您的 Screeps 账号密码，所以在退出应用后您可能需要重新登录。")])],1)],1),a("v-list-item",[a("v-list-item-content",[a("v-list-item-title",{staticClass:"font-weight-bold"},[t._v("开源")]),a("div",{staticClass:"pt-1"},[a("span",[t._v("本应用代码已开源至 github。点击")]),a("a",{on:{click:function(e){return t.openPage(t.githubUrl)}}},[t._v(" 此处")]),a("span",[t._v(" 来访问本项目源码。")])])],1)],1)],1)],1)},Ht=[],Ut=function(t){function e(){var t;return Object(v["a"])(this,e),t=Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.githubUrl="https://github.com/HoPGoldy/screeps-commander",t.homePage="https://hopgoldy.github.io/",t}return Object(p["a"])(e,t),Object(C["a"])(e,[{key:"openPage",value:function(t){window.open(t)}}]),e}(f["e"]);Ut=Object(h["a"])([f["a"]],Ut);var Xt=Ut,zt=Xt,Kt=Object(D["a"])(zt,Rt,Ht,!1,null,null,null),Qt=Kt.exports;N()(Kt,{VCard:E["a"],VCardText:M["b"],VListItem:F["a"],VListItemContent:W["a"],VListItemTitle:W["c"]});var Yt={ButtonEdit:ct,ButtonConfig:ht,ShardSetter:jt,TokenSetter:It,LoadConfig:Et,SaveConfig:Gt,About:Qt},Zt=function(t){function e(){var t;return Object(v["a"])(this,e),t=Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.items=[{title:"创建新按钮",comp:"button-edit",icon:"mdi-plus-box-multiple",persistent:!0},{title:"配置按钮",comp:"button-config",icon:"mdi-cursor-default-click",persistent:!1},{title:"设置 shard",comp:"shard-setter",icon:"mdi-server",persistent:!1},{title:"管理 AuthToken",comp:"token-setter",icon:"mdi-alpha-t-box",persistent:!1},{title:"导出配置项",comp:"save-config",icon:"mdi-download-multiple",persistent:!1},{title:"导入配置项",comp:"load-config",icon:"mdi-upload-multiple",persistent:!1},{title:"关于",comp:"about",icon:"mdi-help-box",persistent:!1}],t.show=!1,t.sidebarVisiable=!1,t.sidebarDrawerVisiable=!1,t.sidebarPersistent=!1,t.activeSidebar="save-config",t}return Object(p["a"])(e,t),Object(C["a"])(e,[{key:"syncShow",value:function(t){this.sidebarDrawerVisiable=t}},{key:"emitCloseEvent",value:function(t){t||this.closeDrawer()}},{key:"onClickSidebar",value:function(t,e){this.sidebarVisiable=!0,this.sidebarDrawerVisiable=!1,this.activeSidebar=t,this.sidebarPersistent=e}},{key:"onSidebarFinish",value:function(t){this.sidebarVisiable=!1,t.show&&this.$toast(t.content||"设置成功",{color:t.color})}},{key:"closeDrawer",value:function(){}}]),e}(f["e"]);Object(h["a"])([Object(f["d"])({required:!0})],Zt.prototype,"show",void 0),Object(h["a"])([Object(f["f"])("show")],Zt.prototype,"syncShow",null),Object(h["a"])([Object(f["f"])("sidebarDrawerVisiable")],Zt.prototype,"emitCloseEvent",null),Object(h["a"])([Object(f["b"])("on-close")],Zt.prototype,"closeDrawer",null),Zt=Object(h["a"])([Object(f["a"])({components:Object(y["a"])({},Yt)})],Zt);var te=Zt,ee=te,ae=a("34c3"),ne=a("f774"),ie=Object(D["a"])(ee,k,g,!1,null,"519b489d",null),se=ie.exports;N()(ie,{VDialog:A["a"],VDivider:K["a"],VIcon:st["a"],VList:bt["a"],VListItem:F["a"],VListItemContent:W["a"],VListItemIcon:ae["a"],VListItemSubtitle:W["b"],VListItemTitle:W["c"],VNavigationDrawer:ne["a"]});var oe=function(t){function e(){var t;return Object(v["a"])(this,e),t=Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.sideDrawerVisiable=!1,t}return Object(p["a"])(e,t),e}(f["e"]);oe=Object(h["a"])([Object(f["a"])({components:{Navigation:se}})],oe);var re=oe,ce=re,le=(a("374d"),a("7496")),ue=a("40dc"),de=a("5bc1"),ve=a("a75b"),me=a("2a7f"),be=Object(D["a"])(ce,u,d,!1,null,"2f9efaa0",null),pe=be.exports;N()(be,{VApp:le["a"],VAppBar:ue["a"],VAppBarNavIcon:de["a"],VContent:ve["a"],VToolbarTitle:me["a"]});var he=a("8c4f"),fe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"console-container"},[a("v-list",{attrs:{dense:""}},[a("v-list-item-group",{attrs:{color:"primary"}},t._l(t.messageList,(function(e,n){return a("div",{key:n,staticClass:"item"},[a("console-item",{attrs:{content:e.content,icon:e.icon,loading:e.loading},on:{"on-icon-click":t.pasteMessage,"on-item-click":function(a){return t.onItemClick(e)}}})],1)})),0),a("div",{directives:[{name:"intersect",rawName:"v-intersect",value:t.onIntersect,expression:"onIntersect"}],ref:"itemList",staticClass:"fill-block"}),a("v-text-field",{staticClass:"input-box ma-4 mr-8",attrs:{rounded:"",label:"键入命令",solo:"","hide-details":"",clearable:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onCommandSend(e)}},model:{value:t.inputCommand,callback:function(e){t.inputCommand=e},expression:"inputCommand"}}),a("v-fab-transition",[a("v-btn",{directives:[{name:"show",rawName:"v-show",value:t.inputCommand&&t.inputCommand.length>0,expression:"inputCommand && inputCommand.length > 0"}],staticClass:"fab-btn",attrs:{color:"green",dark:"",fixed:"",bottom:"",right:"",fab:""},on:{click:t.onCommandSend}},[a("v-icon",[t._v("mdi-arrow-right-thick")])],1)],1),a("v-fab-transition",[a("v-btn",{directives:[{name:"show",rawName:"v-show",value:!t.inputCommand||t.inputCommand.length<=0,expression:"!inputCommand || inputCommand.length <= 0"}],staticClass:"fab-btn",attrs:{color:"pink",dark:"",fixed:"",bottom:"",right:"",fab:""},on:{click:function(e){t.commandListVisiable=!0}}},[a("v-icon",[t._v("mdi-code-braces")])],1)],1)],1),a("command-list",{attrs:{show:t.commandListVisiable},on:{"on-close":function(e){t.commandListVisiable=!1},"on-select":t.getCommand}}),a("boot",{attrs:{show:t.bootVisable},on:{"on-finish":t.onLoginSuccess}}),a("login",{attrs:{show:t.loginVisable},on:{"on-success":t.onLoginSuccess}})],1)},ke=[],ge=(a("99af"),a("0481"),a("a15b"),a("4069"),a("1276"),a("2909")),ye=(a("d3b7"),a("25f0"),a("3ca3"),a("ddb0"),a("3835")),Ce=function(t){function e(){return Object(v["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(p["a"])(e,t),Object(C["a"])(e,[{key:"initScreepsApi",value:function(t){var e=this,a=this.getPlayerInfo(t),n=this.initWebSocket();return Promise.all([a,n]).then((function(t){var a=Object(ye["a"])(t,2),n=a[0],i=a[1];return e.playerInfo=n,e.authSessionToken(i,n.sessionToken)})).then((function(t){var a=t.ws,n=t.sessionToken;return console.log("准备就绪！",n,a),e.screepsWebSock=a,e.playerInfo.sessionToken=n,e.subscribeConsole(e.screepsWebSock,e.playerInfo.userId)}))}},{key:"initWebSocket",value:function(){var t=this;return new Promise((function(e,a){try{var n="wss://screeps.com/socket/".concat(t.getRandStr("number",3),"/").concat(t.getRandStr("string",8),"/websocket");console.log("TCL: ScreepsApi -> screepsUrl",n);var i=new WebSocket(n);i.onopen=function(){return e(i)},i.onerror=function(t){return a(t)}}catch(s){a(s)}}))}},{key:"getPlayerInfo",value:function(t){return new Promise((function(e,a){c("/api/auth/me",{},{"X-token":t}).then((function(t){200===t.status&&1===t.data.ok?e({username:t.data.username,userId:t.data._id,money:t.data.money,sessionToken:t.config.headers["X-token"]}):a(new Error(t.status.toString()))})).catch((function(t){return a(t)}))}))}},{key:"sendConsoleExpression",value:function(t,e){return l("/api/user/console",{expression:t,shard:e},{"X-token":this.playerInfo.sessionToken})}},{key:"authSessionToken",value:function(t,e){return new Promise((function(a,n){t.send('["auth '.concat(e,'"]')),t.onmessage=function(e){if("a"===e.data[0]){var i=JSON.parse(e.data.substring(1))[0];i.includes("auth ok")?a({ws:t,sessionToken:i.split(" ")[2]}):i.includes("auth failed")&&n(e)}}}))}},{key:"subscribeConsole",value:function(t,e){return new Promise((function(a){t.send('["subscribe user:'.concat(e,'/console"]')),console.log("已订阅控制台"),a(t)}))}},{key:"getSessionToken",value:function(t,e){return new Promise((function(a,n){l("/api/auth/signin",{email:t,password:e}).then((function(t){200===t.status&&1===t.data.ok?a(t.data.token):n(new Error(t.status.toString()))})).catch((function(t){return n(t)}))}))}},{key:"getRandStr",value:function(t,e){for(var a="number"===t?"0123456789":"abcdefghijklmnopqrstuvwxyz",n="",i=0;i<e;i++)n+=a.charAt(Math.floor(Math.random()*a.length));return n}},{key:"getDataInMessage",value:function(t){return"a"===t[0]||"m"===t[0]?JSON.parse(t.substr(1,t.length)):[""]}},{key:"closeWebSocket",value:function(){this.screepsWebSock&&this.screepsWebSock.close()}}]),e}(f["e"]);Ce=Object(h["a"])([f["a"]],Ce);var Oe=Ce,je=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-overlay",{attrs:{value:t.show}},[a("v-card",{staticClass:"mx-auto",attrs:{"max-width":"300",light:""}},[a("v-card-title",{staticClass:"title font-weight-regular justify-space-between pb-1"},[a("span",[t._v(t._s(t.currentTitle))])]),a("v-window",{model:{value:t.step,callback:function(e){t.step=e},expression:"step"}},[a("v-window-item",{attrs:{value:1}},[a("div",{staticClass:"pa-2 pt-0"},t._l(t.introduceContent,(function(e,n){return a("v-list-item",{key:n},[a("v-list-item-content",[a("v-list-item-title",{staticClass:"font-weight-bold"},[t._v(t._s(e.title))]),a("div",{staticClass:"content"},[t._v(t._s(e.text))])],1)],1)})),1)]),a("v-window-item",{attrs:{value:2}},[a("v-divider"),a("v-tabs",{staticClass:"mb-4",attrs:{"fixed-tabs":""},model:{value:t.loginTab,callback:function(e){t.loginTab=e},expression:"loginTab"}},[a("v-tab",[t._v("token")]),a("v-tab",[t._v("账号密码")])],1),a("v-tabs-items",{model:{value:t.loginTab,callback:function(e){t.loginTab=e},expression:"loginTab"}},[a("v-tab-item",{key:"token"},[a("v-card-text",{staticClass:"pt-0"},[a("v-text-field",{attrs:{label:"Screeps AuthToken","hide-details":""},model:{value:t.token,callback:function(e){t.token=e},expression:"token"}}),a("div",{staticClass:"mt-5 caption grey--text text--darken-1"},[a("span",[t._v("token 将会被保存至本地以执行免验证登录。点击")]),a("a",{on:{click:function(e){return t.openPage(t.tokenCreateUrl)}}},[t._v(" 此处")]),a("span",[t._v(" 来生成您的 token。")])])],1)],1),a("v-tab-item",{key:"account"},[a("v-card-text",{staticClass:"pt-0"},[a("v-text-field",{attrs:{label:"Screeps 登陆邮箱","hide-details":""},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}}),a("v-text-field",{staticClass:"mt-2",attrs:{label:"Screeps 登陆密码","hide-details":"","append-icon":t.passwordVisiable?"mdi-eye":"mdi-eye-off",type:t.passwordVisiable?"text":"password"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.next(e)},"click:append":function(e){t.passwordVisiable=!t.passwordVisiable}},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),a("div",{staticClass:"mt-5 caption grey--text text--darken-1"},[t._v("本应用不会记录您的任何身份信息，所以在退出应用后将需要重新登录。")])],1)],1)],1)],1),a("v-window-item",{attrs:{value:3}},[a("div",{staticClass:"pa-2 pt-0 text-center"},[a("v-list-item",[a("v-list-item-content",[a("div",{staticClass:"title mb-4"},[t._v("欢迎回来！")]),a("div",{staticClass:"subtitle-1"},[t._v("现在你可以直接与 Screeps 控制台进行交互，所有控制台输出也会直接反馈到本应用中。")]),a("div",{staticClass:"subtitle-1"},[t._v("同时你也可以自定义快捷命令来快速执行某些常用操作。点击左上角菜单来了解更多操作。")])])],1)],1)])],1),a("v-divider"),a("v-card-actions",[a("v-btn",{attrs:{disabled:1===t.step,text:""},on:{click:function(e){t.step--}}},[t._v("上一步")]),a("v-spacer"),a("v-btn",{attrs:{color:"primary",depressed:"",loading:t.confirmBtnLoading},on:{click:t.next}},[t._v("确认")])],1)],1)],1)},we=[],Ve=function(t){function e(){var t;return Object(v["a"])(this,e),t=Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.tokenCreateUrl="https://screeps.com/a/#!/account/auth-tokens",t.introduceContent=[{title:"数据",text:"本应用所有数据均保存在本地，自动或手动清除浏览器缓存将可能导致数据丢失（确保浏览器已退出无痕模式），请妥善使用导出 / 导入功能。"},{title:"网络",text:"本应用不会优化与 Screeps 的连接质量，在网络不好时可能会出现命令丢失等问题。"},{title:"开源",text:"本应用代码已开源至 github。更多信息请访问”关于“页。"}],t.loginTab=0,t.step=1,t.passwordVisiable=!1,t.token="",t.email="",t.password="",t.sessionToken="",t.confirmBtnLoading=!1,t}return Object(p["a"])(e,t),Object(C["a"])(e,[{key:"finishBoot",value:function(){return S.init(),{token:this.sessionToken,type:0===this.loginTab?"token":"account"}}},{key:"next",value:function(){2===this.step?this.login():3===this.step?this.finishBoot():this.step++}},{key:"login",value:function(){this.confirmBtnLoading||(0===this.loginTab?this.tokenAuth():1===this.loginTab&&this.accountAuth())}},{key:"tokenAuth",value:function(){var t=this;this.token&&(this.confirmBtnLoading=!0,this.$toast.info("正在向 Screeps 服务器验证身份..."),this.getPlayerInfo(this.token).then((function(e){S.setToken(t.token),t.sessionToken=e.sessionToken,t.step++,t.$toast.success("验证成功，免登陆验证已启用"),t.confirmBtnLoading=!1})).catch((function(e){t.confirmBtnLoading=!1,t.$toast.error(e.message.includes("401")?"验证失败，请检查 token 是否正确":"验证失败, 错误信息如下: "+e.message)})))}},{key:"accountAuth",value:function(){var t=this;this.email&&this.password&&(this.confirmBtnLoading=!0,this.$toast.info("正在向 Screeps 服务器验证身份..."),this.getSessionToken(this.email,this.password).then((function(e){t.sessionToken=e,t.step++,t.$toast.success("验证成功"),t.confirmBtnLoading=!1})).catch((function(e){t.confirmBtnLoading=!1,t.$toast.error(e.message.includes("401")?"验证失败，请检查用户名密码是否正确":"验证失败, 错误信息如下: "+e.message)})))}},{key:"openPage",value:function(t){window.open(t)}},{key:"currentTitle",get:function(){switch(this.step){case 1:return"使用须知";case 2:return"账户确认";case 3:return"";default:return"初始化"}}}]),e}(Object(f["c"])(Oe));Object(h["a"])([Object(f["d"])()],Ve.prototype,"show",void 0),Object(h["a"])([Object(f["b"])("on-finish")],Ve.prototype,"finishBoot",null),Ve=Object(h["a"])([f["a"]],Ve);var xe=Ve,_e=xe,Se=(a("4223"),a("a797")),Te=a("71a3"),Ie=a("c671"),Le=a("fe57"),Pe=a("aac8"),Be=a("f665"),De=a("1e6c"),$e=Object(D["a"])(_e,je,we,!1,null,"66e5f8a4",null),Ne=$e.exports;N()($e,{VBtn:z["a"],VCard:E["a"],VCardActions:M["a"],VCardText:M["b"],VCardTitle:M["c"],VDivider:K["a"],VListItem:F["a"],VListItemContent:W["a"],VListItemTitle:W["c"],VOverlay:Se["a"],VSpacer:Q["a"],VTab:Te["a"],VTabItem:Ie["a"],VTabs:Le["a"],VTabsItems:Pe["a"],VTextField:Y["a"],VWindow:Be["a"],VWindowItem:De["a"]});var Ee=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-overlay",{attrs:{value:t.show}},[a("v-card",{staticClass:"mx-auto",attrs:{"max-width":"300",light:""}},[a("v-card-title",{staticClass:"title font-weight-regular justify-space-between pb-1"},[t._v("身份认证")]),a("v-card-text",{staticClass:"px-2 pb-2"},[a("v-text-field",{staticClass:"ma-2",attrs:{label:"Screeps 登陆邮箱","hide-details":""},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}}),a("v-text-field",{staticClass:"ma-2",attrs:{label:"Screeps 登陆密码","hide-details":"","append-icon":t.passwordVisiable?"mdi-eye":"mdi-eye-off",type:t.passwordVisiable?"text":"password"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.login(e)},"click:append":function(e){t.passwordVisiable=!t.passwordVisiable}},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),a("div",{staticClass:"ma-2 caption grey--text text--darken-1"},[t._v("本应用不会记录您的任何身份信息，所以在退出应用后将需要重新登录。")]),a("v-btn",{attrs:{color:"primary",block:"",depressed:"",loading:t.loading},on:{click:t.login}},[t._v("登陆")])],1)],1)],1)},Me=[],Ae=function(t){function e(){var t;return Object(v["a"])(this,e),t=Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.passwordVisiable=!1,t.email="",t.password="",t.loading=!1,t}return Object(p["a"])(e,t),Object(C["a"])(e,[{key:"login",value:function(){var t=this;""===this.email||""===this.password||this.loading||(this.loading=!0,this.$toast.info("正在向 Screeps 服务器验证身份..."),this.getSessionToken(this.email,this.password).then((function(e){t.loginSuccess(e)})).catch((function(){t.loading=!1,t.$toast.error("验证失败，请验证用户名密码是否正确")})))}},{key:"loginSuccess",value:function(t){return{token:t,type:"account"}}}]),e}(Object(f["c"])(Oe));Object(h["a"])([Object(f["d"])()],Ae.prototype,"show",void 0),Object(h["a"])([Object(f["b"])("on-success")],Ae.prototype,"loginSuccess",null),Ae=Object(h["a"])([f["a"]],Ae);var Fe=Ae,We=Fe,Je=(a("6695"),Object(D["a"])(We,Ee,Me,!1,null,"03900afd",null)),qe=Je.exports;N()(Je,{VBtn:z["a"],VCard:E["a"],VCardText:M["b"],VCardTitle:M["c"],VOverlay:Se["a"],VTextField:Y["a"]});var Ge=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"console-item-contaienr"},[a("v-list-item",{attrs:{ripple:!1}},[a("v-list-item-icon",{staticClass:"my-3 mr-4"},[a("v-btn",{attrs:{icon:"",small:"",loading:t.loading},on:{click:t.copyContent}},[a("v-icon",{attrs:{color:t.iconColor}},[t._v(t._s(t.icon))])],1)],1),a("v-list-item-content",{on:{click:t.onContentClick}},[a("div",{ref:"content",staticClass:"body-2"},t._l(t.content,(function(t){return a("div",{staticClass:"my-2"})})),0)])],1),a("v-divider")],1)},Re=[],He=function(t){function e(){return Object(v["a"])(this,e),Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(p["a"])(e,t),Object(C["a"])(e,[{key:"refrashContent",value:function(t){for(var e=this.$refs.content,a=0;a<e.children.length;a++)e.children[a].innerHTML=t[a]}},{key:"onContentClick",value:function(){}},{key:"copyContent",value:function(){return this.content}},{key:"mounted",value:function(){this.refrashContent(this.content)}},{key:"iconColor",get:function(){return"mdi-arrow-bottom-right-thick"===this.icon?"amber":"mdi-arrow-top-left-thick"===this.icon?"light-blue":"mdi-alert-circle"===this.icon?"error":"light-green"}}]),e}(f["e"]);Object(h["a"])([Object(f["d"])({required:!0})],He.prototype,"content",void 0),Object(h["a"])([Object(f["d"])({required:!0})],He.prototype,"icon",void 0),Object(h["a"])([Object(f["d"])({default:!0})],He.prototype,"loading",void 0),Object(h["a"])([Object(f["f"])("content")],He.prototype,"refrashContent",null),Object(h["a"])([Object(f["b"])("on-item-click")],He.prototype,"onContentClick",null),Object(h["a"])([Object(f["b"])("on-icon-click")],He.prototype,"copyContent",null),He=Object(h["a"])([f["a"]],He);var Ue=He,Xe=Ue,ze=Object(D["a"])(Xe,Ge,Re,!1,null,null,null),Ke=ze.exports;N()(ze,{VBtn:z["a"],VDivider:K["a"],VIcon:st["a"],VListItem:F["a"],VListItemContent:W["a"],VListItemIcon:ae["a"]});var Qe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-bottom-sheet",{on:{"click:outside":t.close},model:{value:t.sheetVisiable,callback:function(e){t.sheetVisiable=e},expression:"sheetVisiable"}},[a("v-list",t._l(t.commandListData,(function(e,n){return a("div",{key:n,staticClass:"item"},[a("v-list-item",{on:{click:function(a){return t.onCommandClick(e)}}},[a("v-chip",{staticClass:"mr-3",attrs:{small:"",disabled:""}},[t._v(t._s(e.shard||"全局"))]),a("span",{staticClass:"d-inline-block text-truncate text-no-wrap"},[t._v(t._s(e.title))])],1),n!=t.commandListData.length-1?a("v-divider"):t._e()],1)})),0),a("parameter-collecter",{attrs:{show:t.parameterCollecterVisiable},on:{"on-close":t.onParamClose,"on-finish":t.onParamFinish},model:{value:t.collectingParam,callback:function(e){t.collectingParam=e},expression:"collectingParam"}})],1)},Ye=[],Ze=(a("4d63"),a("5319"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{attrs:{persistent:""},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("v-card",[a("v-card-title",{staticClass:"title font-weight-regular justify-space-between pb-1"},[t._v("请填写参数")]),t._l(t.paramInputs,(function(e,n){return a("div",{key:n,staticClass:"mx-2 px-2"},[a("v-text-field",{staticClass:"mb-4",attrs:{label:e.label,"hide-details":"",clearable:""},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}})],1)})),a("v-divider"),a("v-card-actions",[a("v-btn",{attrs:{width:"100"},on:{click:t.close}},[t._v("放弃")]),a("v-spacer"),a("v-btn",{attrs:{width:"100",color:"primary",depressed:""},on:{click:t.returnParam}},[t._v("确认")])],1)],2)],1)}),ta=[],ea=function(t){function e(){var t;return Object(v["a"])(this,e),t=Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.show=!1,t.paramInputs=[],t}return Object(p["a"])(e,t),Object(C["a"])(e,[{key:"loadDefaultValue",value:function(t){t&&(this.paramInputs=this.value.map((function(t){return Object(y["a"])({},t,{value:t.default})})))}},{key:"close",value:function(){}},{key:"returnParam",value:function(){return this.paramInputs.map((function(t){return{match:t.match,value:t.value}}))}}]),e}(f["e"]);Object(h["a"])([Object(f["d"])({required:!0,default:[]})],ea.prototype,"value",void 0),Object(h["a"])([Object(f["d"])({required:!0})],ea.prototype,"show",void 0),Object(h["a"])([Object(f["f"])("show")],ea.prototype,"loadDefaultValue",null),Object(h["a"])([Object(f["b"])("on-close")],ea.prototype,"close",null),Object(h["a"])([Object(f["b"])("on-finish")],ea.prototype,"returnParam",null),ea=Object(h["a"])([f["a"]],ea);var aa=ea,na=aa,ia=Object(D["a"])(na,Ze,ta,!1,null,"68dc2feb",null),sa=ia.exports;N()(ia,{VBtn:z["a"],VCard:E["a"],VCardActions:M["a"],VCardTitle:M["c"],VDialog:A["a"],VDivider:K["a"],VSpacer:Q["a"],VTextField:Y["a"]});var oa=function(t){function e(){var t;return Object(v["a"])(this,e),t=Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.sheetVisiable=!1,t.commandListData=[],t.parameterCollecterVisiable=!1,t.collectingParam=[],t.selectCommand="",t.selectShard="",t}return Object(p["a"])(e,t),Object(C["a"])(e,[{key:"updateData",value:function(t){this.sheetVisiable=t,t&&(this.commandListData=S.get().commands)}},{key:"onCommandClick",value:function(t){this.selectCommand=t.body,this.selectShard=t.shard,t.param.length>0?(this.collectingParam=t.param,this.parameterCollecterVisiable=!0):this.sendCommand(t.body)}},{key:"sendCommand",value:function(t){return this.selectShard||(this.selectShard=S.get().shard),{command:t,shard:this.selectShard}}},{key:"close",value:function(){}},{key:"onParamClose",value:function(){this.parameterCollecterVisiable=!1}},{key:"onParamFinish",value:function(t){this.parameterCollecterVisiable=!1;var e=this.buildCommand(this.selectCommand,t);this.sendCommand(e)}},{key:"buildCommand",value:function(t,e){var a=t;return e.map((function(t){a=a.replace(new RegExp("\\".concat(t.match),"g"),t.value)})),a}}]),e}(f["e"]);Object(h["a"])([Object(f["d"])({required:!0,default:!1})],oa.prototype,"show",void 0),Object(h["a"])([Object(f["f"])("show")],oa.prototype,"updateData",null),Object(h["a"])([Object(f["b"])("on-select")],oa.prototype,"sendCommand",null),Object(h["a"])([Object(f["b"])("on-close")],oa.prototype,"close",null),oa=Object(h["a"])([Object(f["a"])({components:{ParameterCollecter:sa}})],oa);var ra=oa,ca=ra,la=a("288c"),ua=a("cc20"),da=Object(D["a"])(ca,Qe,Ye,!1,null,"750f4b29",null),va=da.exports;N()(da,{VBottomSheet:la["a"],VChip:ua["a"],VDivider:K["a"],VList:bt["a"],VListItem:F["a"]});var ma=function(t){function e(){var t;return Object(v["a"])(this,e),t=Object(m["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.messageList=[],t.commandListVisiable=!1,t.inputCommand="",t.screepsToken="",t.bootVisable=!1,t.loginVisable=!1,t.fillBlockVisiable=!1,t}return Object(p["a"])(e,t),Object(C["a"])(e,[{key:"pasteMessage",value:function(t){this.inputCommand=t.join("\n")}},{key:"onCommandSend",value:function(){this.sendCommand(this.inputCommand,S.get().shard),this.inputCommand=""}},{key:"sendCommand",value:function(t,e){var a=this;if(t&&!(t.length<=0)){var n=this.addNewMessage([t],"mdi-arrow-top-left-thick",!0,e);this.sendConsoleExpression(t,e).then((function(t){console.log("命令发送完成",t),n.loading=!1,t.data.error&&(n.icon="mdi-alert-circle",a.addNewMessage(["发送失败: "+t.data.error],"mdi-alert-circle",!1,e))})).catch((function(t){n.loading=!1,n.icon="mdi-alert-circle",a.addNewMessage(["啊哦，命令发送失败，请尝试刷新网页并重新登陆",t],"mdi-alert-circle",!1,e)})),this.scrollToBottom()}}},{key:"onIntersect",value:function(t){this.fillBlockVisiable=t[0].isIntersecting}},{key:"scrollToBottom",value:function(){console.log("Console -> scrollToBottom -> this.$refs.itemList",this.$refs.itemList),this.$vuetify.goTo(this.$refs.itemList,{duration:1e3})}},{key:"getCommand",value:function(t){this.commandListVisiable=!1,this.sendCommand(t.command,t.shard)}},{key:"onMessage",value:function(t){if("a"===t.data[0]){try{var e=JSON.parse(t.data.substring(1))[0],a=JSON.parse(e)[1],n=[];if(a.error)this.addNewMessage(a.error.split("\n"),"mdi-alert-circle",!1,a.shard);else{if(a.messages.log.length>0&&n.push.apply(n,Object(ge["a"])(a.messages.log.map((function(t){return t.split("\n")})).flat())),a.messages.results.length>0&&n.push.apply(n,Object(ge["a"])(a.messages.results[0].split("\n"))),n.length<=0)return;this.addNewMessage(n,"mdi-arrow-bottom-right-thick",!1,a.shard)}}catch(i){console.log("onMessage 数据解析出错",i,t)}this.fillBlockVisiable&&this.scrollToBottom()}}},{key:"addNewMessage",value:function(t,e){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=new Date,s={content:t,icon:e,loading:a,shard:n,date:"".concat(i.getHours(),":").concat(i.getMinutes(),":").concat(i.getSeconds())};return this.messageList.push(s),s}},{key:"onLoginSuccess",value:function(t){this.bootVisable=!1,this.loginVisable=!1,this.addNewMessage(["token"===t.type?"发现 AuthToken，跳过登录验证":"登录成功"],"mdi-key",!1);var e=this.addNewMessage(["正在订阅 Screeps WebSocket, 请稍后..."],"mdi-wifi");this.screepsToken=t.token,this.createSocket(t.token,e)}},{key:"createSocket",value:function(t,e){var a=this;this.initScreepsApi(t).then((function(t){t.onmessage=a.onMessage,e.loading=!1,e.content=["Screeps WebSocket 订阅成功!"],a.addNewMessage(["您现在可以正常与控制台进行交互"],"mdi-wifi",!1),a.keepSockTimer=setInterval(a.checkSockAlive,1e3)})).catch((function(t){console.log("该死，初始化 ws 出错了!",t),e.loading=!1,e.icon="mdi-alert-circle",e.content=["Screeps WebSocket 订阅失败, 请刷新重试"],t.message.includes("401")&&a.addNewMessage(["当前登录信息已过期，请检查 token 或账号密码是否正确"],"mdi-alert-circle",!1)}))}},{key:"onItemClick",value:function(t){var e=t.shard?"所处镜面 ".concat(t.shard," | "):"";this.$toast.info("".concat(e,"消息时间 ").concat(t.date),{y:"top"})}},{key:"mounted",value:function(){if(S.exist){S.init();var t=S.get().token;t?this.onLoginSuccess({token:t,type:"token"}):this.loginVisable=!0}else this.bootVisable=!0}},{key:"checkSockAlive",value:function(){if(!document.hidden&&this.screepsWebSock){var t=this.screepsWebSock.readyState;2!==t&&3!==t||this.reloadSocket()}}},{key:"reloadSocket",value:function(){var t=this.addNewMessage(["连接已断开，正在重新订阅..."],"mdi-wifi");this.createSocket(this.screepsToken,t),clearInterval(this.keepSockTimer)}},{key:"destroyed",value:function(){this.closeWebSocket()}}]),e}(Object(f["c"])(Oe));ma=Object(h["a"])([Object(f["a"])({components:{ConsoleItem:Ke,CommandList:va,Boot:Ne,Login:qe}})],ma);var ba=ma,pa=ba,ha=(a("5d9d"),a("0789")),fa=a("1baa"),ka=a("269a"),ga=a.n(ka),ya=a("90a2"),Ca=Object(D["a"])(pa,fe,ke,!1,null,"c697d684",null),Oa=Ca.exports;N()(Ca,{VBtn:z["a"],VFabTransition:ha["c"],VIcon:st["a"],VList:bt["a"],VListItemGroup:fa["a"],VTextField:Y["a"]}),ga()(Ca,{Intersect:ya["a"]}),n["a"].use(he["a"]);var ja=[{path:"/",redirect:"/console"},{path:"/console",component:Oa}],wa=new he["a"]({routes:ja}),Va=a("f309"),xa=a("2db4"),_a=a("87f6"),Sa=a.n(_a);n["a"].use(Va["a"],{components:{VSnackbar:xa["a"],VBtn:z["a"],VIcon:st["a"]}}),n["a"].use(Sa.a,{x:"center",showClose:!0,closeIcon:"mdi-close",closeColor:"white"});var Ta=new Va["a"]({}),Ia=a("4eb5"),La=a.n(Ia);La.a.config.autoSetContainer=!0,n["a"].use(La.a),n["a"].config.productionTip=!1,new n["a"]({router:wa,vuetify:Ta,render:function(t){return t(pe)}}).$mount("#app")},f035:function(t,e,a){"use strict";var n=a("143e"),i=a.n(n);i.a}});
//# sourceMappingURL=app.3d2e400e.js.map